packages:
  yum:
    git: []
    gcc: []
    make: []
    openssl-devel: []
    libxml2: []
    libxml2-devel: []    

option_settings:
  - option_name: NODE_ENV
    value: production
  - namespace: aws:elasticbeanstalk:container:nodejs
    option_name: NodeVersion
    value: 0.10.21

files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/50npm.sh" :
    mode: "000775"
    owner: root
    group: root
    content: |
      #!/bin/bash          
      function error_exit
      {
        eventHelper.py --msg "$1" --severity ERROR
        exit $2
      }

      export HOME=/home/ec2-user 
      echo $HOME

      OUT=$(/opt/elasticbeanstalk/containerfiles/ebnode.py --action npm-install 2>&1) || error_exit "Failed to run npm install.  $OUT" $?
      echo $OUT
  "/opt/elasticbeanstalk/hooks/appdeploy/post/npm-install-as.sh" :
    mode: "000775"
    owner: root
    group: root
    content: |
      #!/bin/bash          
      cd /var/app/current
      export HOME=/home/ec2-user 
      echo $HOME
      echo "npm install'ing aerospike"
      /opt/elasticbeanstalk/node-install/node-v0.10.21-linux-x64/bin/npm install aerospike
      echo "done npm install'ing aerospike"